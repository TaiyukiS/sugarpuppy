(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"047d":function(t,s,e){},"6a82":function(t,s,e){t.exports=e.p+"img/coracao.026e808e.svg"},"8b24":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("q-page",[i("q-pull-to-refresh",{on:{refresh:t.buscarPosts}},[i("div",{staticClass:"poster q-py-md"},[i("q-input",{attrs:{outlined:"",autogrow:"",label:"O que você quer compartilhar?"},model:{value:t.post_text,callback:function(s){t.post_text=s},expression:"post_text"}}),i("div",{staticClass:"q-mt-sm"},[t.show_add_img?t._e():i("q-btn",{staticClass:"q-mr-sm",attrs:{label:"Adicionar foto",unelevated:"",outline:""},on:{click:function(s){t.show_add_img=!0}}}),t.show_add_img?i("q-input",{staticClass:"q-mr-sm",attrs:{outlined:"",dense:"",label:"Link da foto"},model:{value:t.post_img,callback:function(s){t.post_img=s},expression:"post_img"}}):t._e(),t.show_add_img?i("q-btn",{staticClass:"q-mr-sm",attrs:{label:"Cancelar",unelevated:"",outline:""},on:{click:function(s){t.show_add_img=!1}}}):t._e(),i("q-btn",{staticClass:"float-right",attrs:{color:"primary",label:"Publicar"},on:{click:t.publicar}})],1),t.msgPublishing?i("h6",{staticClass:"text-center"},[t._v("Publicando...")]):t._e()],1),t.msgSearching?i("h6",{staticClass:"text-center"},[t._v("Buscando...")]):t._e(),t._l(t.posts,(function(s){return i("div",{key:s.id,staticClass:"flex post q-py-md"},[i("a",{staticClass:"flex flex-center q-px-lg heading",on:{click:function(e){return t.redirectProfile(s)}}},[i("img",{staticClass:"profile-picture",attrs:{alt:"Foto do Pet",src:s.foto_poster}}),i("p",{staticClass:"q-ma-none q-ml-sm"},[t._v(t._s(s.nome_poster))]),i("span",[t._v(t._s(t.formatDate(s.data_cadastro)))])]),i("article",{staticClass:"q-my-sm q-px-lg"},[t._v("\n        "+t._s(s.conteudo)+"\n      ")]),s.url_foto?i("div",{staticClass:"gallery"},[i("img",{attrs:{alt:"Foto do Post",src:s.url_foto},on:{dblclick:function(e){return t.toogleLike(s.id)}}}),s.liked?i("img",{staticClass:"heart-photo",attrs:{alt:"Amei",src:e("6a82")}}):t._e()]):t._e(),i("div",{staticClass:"q-px-lg q-mt-md"},[i("q-btn",{class:"like-count "+(s.liked?"liked":""),attrs:{unelevated:"",rounded:"",outline:!s.liked,color:"negative",icon:"favorite_border",label:s.qtd_amei},on:{click:function(e){return t.toogleLike(s.id)}}}),t.temAcessoPost(s)?i("q-btn",{staticClass:"float-right",attrs:{unelevated:"",outline:"",icon:"create"}},[i("q-menu",[i("q-list",[i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[i("q-item-section",{on:{click:function(e){return t.abrirEdicao(s.id)}}},[t._v("Editar")])],1),i("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[i("q-item-section",{on:{click:function(e){return t.abrirRemocao(s.id)}}},[t._v("Apagar")])],1)],1)],1)],1):t._e()],1)])})),t.msgSearchingFim?i("h6",{staticClass:"text-center"},[t._v("Buscando...")]):t._e(),t.msgFim?i("h6",{staticClass:"text-center"},[t._v("Fim :)")]):t._e(),t.show_more_btn?i("div",{staticClass:"q-mt-lg text-center"},[i("q-btn",{attrs:{label:"Carregar Mais",unelevated:"",outline:""},on:{click:t.buscarMaisPosts}})],1):t._e()],2),i("q-dialog",{attrs:{value:t.show_edit_post},on:{input:function(s){return t.fecharEdicao()}}},[i("q-card",{staticStyle:{width:"480px","max-width":"80vw"}},[i("q-card-section",{staticClass:"post"},[i("div",{staticClass:"flex flex-center q-px-lg heading"},[i("img",{staticClass:"profile-picture",attrs:{alt:"Foto do Pet",src:t.postEdit.foto_poster}}),i("p",{staticClass:"q-ma-none q-ml-sm"},[t._v(t._s(t.postEdit.nome_poster))]),i("span",[t._v(t._s(t.formatDate(t.postEdit.data_cadastro)))])]),i("div",{staticClass:"poster"},[i("q-input",{staticClass:"q-my-sm q-px-lg",attrs:{outlined:"",autogrow:""},model:{value:t.postEdit.conteudo,callback:function(s){t.$set(t.postEdit,"conteudo",s)},expression:"postEdit.conteudo"}}),i("div",{staticClass:"q-mt-sm q-px-lg"},[t.show_add_img_edit?t._e():i("q-btn",{staticClass:"q-mr-sm",attrs:{label:"Adicionar foto",unelevated:"",outline:""},on:{click:function(s){t.show_add_img_edit=!0}}}),t.show_add_img_edit?i("q-input",{staticClass:"q-mr-sm",attrs:{outlined:"",dense:"",label:"Link da foto"},model:{value:t.postEdit.url_foto,callback:function(s){t.$set(t.postEdit,"url_foto",s)},expression:"postEdit.url_foto"}}):t._e(),t.show_add_img_edit?i("q-btn",{staticClass:"q-mr-sm",attrs:{label:"Cancelar",unelevated:"",outline:""},on:{click:function(s){t.show_add_img_edit=!1}}}):t._e()],1)],1),t.postEdit.url_foto&&t.show_add_img_edit?i("div",{staticClass:"gallery"},[i("img",{attrs:{alt:"Foto do Post",src:t.postEdit.url_foto}})]):t._e()]),i("q-card-actions",{staticClass:"flex justify-evenly"},[i("q-btn",{attrs:{unelevated:"",label:"Cancelar"},on:{click:t.fecharEdicao}}),i("q-btn",{attrs:{unelevated:"",color:"primary",label:"Atualizar"},on:{click:t.editarPost}})],1)],1)],1),i("q-dialog",{attrs:{value:t.show_delete_post},on:{input:function(s){return t.fecharRemocao()}}},[i("q-card",{staticStyle:{width:"480px","max-width":"80vw"}},[i("q-card-section",{attrs:{align:"center"}},[i("h5",[t._v("Você tem certeza que deseja apagar esse post?")])]),i("q-card-actions",{staticClass:"flex justify-evenly"},[i("q-btn",{attrs:{unelevated:"",label:"Cancelar"},on:{click:t.fecharRemocao}}),i("q-btn",{attrs:{unelevated:"",color:"primary",label:"Apagar"},on:{click:t.apagarPost}})],1)],1)],1)],1)},o=[],a=(e("a434"),e("e6cf"),e("a79d"),e("ddb0"),e("ded3")),r=e.n(a),n=e("bd4c"),c=e("ae2c"),l=e("d765");const d=l["a"].get("login");var u={name:"PageIndex",data(){return{post_text:"",post_img:"",show_add_img:!1,show_add_img_edit:!1,show_edit_post:!1,show_delete_post:!1,show_more_btn:!1,msgPublishing:!1,msgSearching:!1,msgSearchingFim:!1,msgFim:!1,indexPagina:1,posts:[],postEdit:{},postDelete:null}},mounted(){this.buscarPosts()},methods:{formatDate(t){return n["a"].formatDate(new Date(t),"DD/MM/YYYY HH:mm")},toogleLike(t){let s=null;for(let e=0;e<this.posts.length;e++)if(this.posts[e].id===t){this.posts[e].liked?this.posts[e].qtd_amei--:this.posts[e].qtd_amei++,this.posts[e].liked=!this.posts[e].liked,s=this.posts[e].liked;break}null!==s&&(s?c["a"].like(t):c["a"].dislike(t))},temAcessoPost(t){return d.id_usuario===t.id_usuario||d.id_pet===t.id_pet},publicar(){const t={conteudo:this.post_text};this.show_add_img&&(t.url_foto=this.post_img),0!==t.conteudo.length||t.url_foto&&0!==t.url_foto.length?(this.msgPublishing=!0,c["a"].publicar(t).then((t=>{this.posts.unshift(t),this.sucessoPublicar()})).catch((()=>{this.erroPublicar()}))):this.$q.notify({message:"O post deve conter um texto ou uma foto!",color:"negative"})},sucessoPublicar(){this.show_add_img=!1,this.post_text="",this.post_img="",this.msgPublishing=!1,this.$q.notify({message:"Publicado!",color:"primary"})},erroPublicar(){this.show_add_img=!1,this.post_text="",this.post_img="",this.msgPublishing=!1,this.$q.notify({message:"Ops! Houve algum erro",color:"negative"})},buscarPosts(t){this.msgSearching=!0,c["a"].get().then((s=>{this.indexPagina=1,this.msgFim=!1,this.show_more_btn=!0,this.posts=s,t&&t()})).finally((()=>{this.msgSearching=!1}))},buscarMaisPosts(){this.msgSearchingFim=!0,this.show_more_btn=!1,this.indexPagina++,c["a"].get({pagina:this.indexPagina}).then((t=>{0===t.length?(this.msgFim=!0,this.show_more_btn=!1):(this.show_more_btn=!0,this.posts.push(...t))})).finally((()=>{this.msgSearchingFim=!1}))},abrirEdicao(t){const s=this.posts.filter((s=>s.id===t));s.length>0&&(this.postEdit=r()({},s[0]),this.show_add_img_edit=!1,this.postEdit.url_foto&&(this.show_add_img_edit=!0),this.show_edit_post=!0)},fecharEdicao(){this.show_add_img_edit=!1,this.show_edit_post=!1,this.postEdit={}},editarPost(){const t=this.postEdit.id,s={conteudo:this.postEdit.conteudo,url_foto:""};if(this.show_add_img_edit&&(s.url_foto=this.postEdit.url_foto),0===s.conteudo.length&&0===s.url_foto.length)return void this.$q.notify({message:"O post deve conter um texto ou uma foto!",color:"negative"});const e=r()({},this.postEdit);this.fecharEdicao();const i=this.$q.notify({message:"Atualizando..."});c["a"].atualizar(t,s).then((s=>{i(),this.$q.notify({message:"Atualizado!",color:"primary"});for(let i=0;i<this.posts.length;i++)if(this.posts[i].id===t){this.posts[i].conteudo=e.conteudo,this.posts[i].url_foto=e.url_foto;break}})).catch((()=>{i(),this.$q.notify({message:"Ops! Houve algum erro",color:"negative"})}))},abrirRemocao(t){this.show_delete_post=!0,this.postDelete=t},fecharRemocao(){this.show_delete_post=!1,this.postDelete=null},apagarPost(){const t=this.postDelete;this.fecharRemocao();const s=this.$q.notify({message:"Apagando..."});c["a"].apagar(t).then((e=>{s(),this.$q.notify({message:"Apagado!",color:"primary"});for(let s=0;s<this.posts.length;s++)if(this.posts[s].id===t){this.posts.splice(s,1);break}})).catch((()=>{s(),this.$q.notify({message:"Ops! Houve algum erro",color:"negative"})}))},redirectProfile(t){t.id_pet?this.$router.push("/pet?id="+t.id_pet):this.$router.push("/user?id="+t.id_usuario)}}},h=u,p=(e("9a05"),e("2877")),m=e("9989"),_=e("59d7"),g=e("27f9"),f=e("9c40"),b=e("4e73"),q=e("1c1c"),v=e("66e5"),w=e("4074"),k=e("24e8"),y=e("f09f"),P=e("a370"),x=e("4b7e"),C=e("7f67"),E=e("eebe"),$=e.n(E),A=Object(p["a"])(h,i,o,!1,null,"50155a1c",null);s["default"]=A.exports;$()(A,"components",{QPage:m["a"],QPullToRefresh:_["a"],QInput:g["a"],QBtn:f["a"],QMenu:b["a"],QList:q["a"],QItem:v["a"],QItemSection:w["a"],QDialog:k["a"],QCard:y["a"],QCardSection:P["a"],QCardActions:x["a"]}),$()(A,"directives",{ClosePopup:C["a"]})},"9a05":function(t,s,e){"use strict";var i=e("047d"),o=e.n(i);o.a},ae2c:function(t,s,e){"use strict";e.d(s,"a",(function(){return d}));e("e6cf");var i=e("758b");async function o(t){try{return i["a"].get("/posts",{params:t})}catch(s){return await Promise.reject(s)}}async function a(t){try{return i["a"].post(`/posts/${t}/like`)}catch(s){return await Promise.reject(s)}}async function r(t){try{return i["a"].post(`/posts/${t}/dislike`)}catch(s){return await Promise.reject(s)}}async function n(t){try{return i["a"].post("/posts",t)}catch(s){return await Promise.reject(s)}}async function c(t,s){try{return i["a"].put("/posts/"+t,s)}catch(e){return await Promise.reject(e)}}async function l(t){try{return i["a"].delete("/posts/"+t)}catch(s){return await Promise.reject(s)}}const d={get:o,like:a,dislike:r,publicar:n,atualizar:c,apagar:l}}}]);